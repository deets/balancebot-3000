<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="/static/js/jquery-2.1.4.min.js"></script>
    <script src="/static/js/underscore-min.js"></script>
    <script src="/static/js/three.min.js"></script>
    <script src="/static/js/d3.min.js"></script>
    <script src="http://threejs.org/examples/js/loaders/OBJLoader.js"></script>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/visualization.css" rel="stylesheet">
  </head>
  <body>
    <div id="startscreen" class="container-fluid">
      <div class="page-header">
	<h1>BalanceBot 3000<small>Data Visualization</small></h1>
      </div>
      </div>
      <div class="row">
    	<div class="col-md-6" id="graph">
    	</div>
    	<div class="col-md-6" id="view">
    	</div>
      </div>
      <div class="row">
	<div class="col-md-6">
	  <div class="btn-group" role="group" aria-label="...">
	    <button id="clear_button" type="button" class="btn btn-default">Clear</button>
	    <button id="limit_button" type="button" class="btn btn-default">Limit</button>
	    <button id="scene_button" type="button" class="btn btn-default">Turn on 3D Scene</button>
</div>
	</div>
	<div class="col-md-6"></div>
      </div>
    </div>
    <script src="/static/js/bootstrap.js"></script>
    <script src="/static/js/visualization.js"></script>

    <script>
$(document).ready(function() {
  var graph = setupGraph("#graph", { "limit" : 300 });
  <!-- graph.line( -->
  <!--    function(d) { return d.timestamp;}, -->
  <!--    function(d) { return d.debugData.kf.gyroX; }, -->
  <!--    { color : "red", global_minmax : true } -->
  <!-- ).line( -->
  <!--    function(d) { return d.timestamp;}, -->
  <!--    function(d) { return d.debugData.kf.gyroXOriginal; }, -->
  <!--    { "color" : "green", global_minmax : true } -->
  <!-- graph.line( -->
  <!--    function(d) { return d.timestamp;}, -->
  <!--    function(d) { return d.debugData.kf.atanAccX; }, -->
  <!--    { "color" : "blue", global_minmax : true } -->
  <!-- ); -->
  graph.line(
     function(d) { return d.timestamp;},
     function(d) { return d.acc[2]; },
     { "color" : "#ff00ff", global_minmax : true }
  ).line(
     function(d) { return d.timestamp;},
     function(d) { return d.acc[1]; },
     { "color" : "#000000", global_minmax : true }
  ).line(
     function(d) { return d.timestamp;},
     function(d) { return d.acc[0]; },
     { "color" : "steelblue", global_minmax : true }
  ).line(
     function(d) { return d.timestamp;},
     function(d) { return d.debugData.kf.atanAccY; },
     { "color" : "blue", global_minmax : true }
  );

  function toggle3Dscene() {
     if(sceneCb === null) {
        sceneCb = setupScene();
     } else {
        $("#view").empty();
        sceneCb = null;
     }
  }
  $("#clear_button").click(graph.clear);
  $("#limit_button").click(function() { graph.limit(300, true); });
  $("#scene_button").click(toggle3Dscene);

  var sceneCb = null;

  setupWebsocket(function(data) {
    graph.dataCallback(data);
    if(sceneCb !== null) {
       sceneCb(data);
    }
  });

  toggle3Dscene();
});
</script>
  </body>
</html>
